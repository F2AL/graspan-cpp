#! /bin/bash

GRAMMAR=resources/grammar
INPGRAPH=preproc/bigtest.txt
NUMPARTITIONS=3
MEMBUDGET=4

echo "resetting..."
rm -f resources/*
cp originalTest/* resources/

echo "running..."
../bin/comp numPartitions=$NUMPARTITIONS insertionSort=false alterSchedule=false memBudget=$MEMBUDGET inputGraph=$INPGRAPH grammar=$GRAMMAR > log/cpp.$MEMBUDGET.$NUMPARTITIONS.output &

sleep 1

PID=$( echo $( ps -f  | grep "../../bin/comp" | awk '{print $2}' ) | awk '{print $1}' )
./utilities/pmap.sh $PID > log/pmap.$MEMBUDGET.$NUMPARTITIONS.output
